<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Vibrant Flight ‚Äî Elavate Your Journey</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <style>
      .searchdiv {
        position: absolute;
        top: 75%;
        right: 15%;
      }
      html {
        scroll-behavior: smooth;
      }
    </style>
  </head>
  <body>
    <!-- TOP PROMO -->
    <div
      class="w-full bg-gradient-to-r from-[#080808] to-[#000] text-xs text-gray-300 py-2"
    >
      <div
        class="max-w-screen-xl mx-auto px-4 flex items-center justify-between"
      >
        <div class="offer-banner">
          <div class="offer-text">
            FLAT ‚Çπ500 OFF on orders ‚Çπ2,000+ ‚Ä¢ FREE SHIPPING over ‚Çπ1,999 ‚Ä¢ COD
            available ‚Ä¢ 7-day returns ‚Ä¢ 500+ Reviews
          </div>
        </div>
      </div>
    </div>

    <!-- HEADER -->
    <header
      class="relative z-50 w-full bg-black/70 backdrop-blur-md border-b border-white/10"
    >
      <div
        class="max-w-screen-xl mx-auto flex items-center justify-between px-4 py-3 md:py-5"
      >
        <!-- Logo -->
        <div class="flex items-center gap-2 flex-shrink-0">
          <img
            src="/images/logo.jpg"
            alt="Vibrant Flight Logo"
            class="w-9 h-9 md:w-10 md:h-10 rounded-md border border-[#D4AF37]/50 shadow-lg"
          />
        </div>

        <!-- Brand -->
        <h1
          class="flex-1 text-center text-transparent bg-clip-text bg-gradient-to-r from-amber-300 via-yellow-100 to-amber-400 text-2xl sm:text-3xl md:text-4xl font-[Cinzel] tracking-[0.2em] drop-shadow-[0_0_12px_rgba(212,175,55,0.35)] animate-title-shimmer"
        >
          Vibrant Flight
        </h1>

        <!-- Icons -->
        <div class="flex items-center gap-2 sm:gap-3 flex-shrink-0">
          <!-- Menu Search Icon -->
          <!-- üîç MENU SEARCH ICON (top navigation) -->
          <!-- üîç MENU SEARCH ICON -->
          <button
            id="menuSearchBtn"
            class="p-2 flex items-center justify-center rounded-lg transition hover:bg-white/10"
            title="Search"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6 text-gray-300 transition hover:text-[#D4AF37]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M21 21l-5.5-5.5m2-5a6.5 6.5 0 11-13 0 6.5 6.5 0 0113 0z"
              />
            </svg>
          </button>

          <!-- üåê FULL-WIDTH SEARCH BAR (GLASS EFFECT) -->
          <div
            id="searchWrapper"
            class="hidden fixed top-0 left-0 w-full flex justify-center bg-black/70 backdrop-blur-xl border-b border-white/20 shadow-lg opacity-0 -translate-y-5 transition-all duration-500 ease-in-out z-50 py-4 px-6"
          >
            <div class="relative w-full max-w-2xl flex items-center gap-3">
              <!-- Search Field -->
              <input
                id="searchInput"
                type="text"
                placeholder="Search premium products..."
                class="flex-1 bg-white/10 border border-white/20 rounded-2xl px-5 py-3 text-base text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:bg-white/20 transition-all duration-300"
              />
              <!-- Search Icon -->
              <button
                id="searchBtn"
                class="p-3 flex items-center justify-center hover:bg-white/10 rounded-full shadow-md transition"
                title="Search"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-5 h-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                  />
                </svg>
              </button>
              <!-- Close Button -->
              <button
                id="closeSearch"
                class="px-3 py-2 rounded-full bg-white/10 hover:bg-white/20 text-gray-300 hover:text-yellow-400 transition"
                title="Close search"
              >
                ‚úñ
              </button>

              <!-- Suggestions Box (directly under input) -->
              <div
                id="suggestionsBox"
                class="absolute hidden top-full left-0 mt-3 w-full bg-black/90 backdrop-blur-lg border border-white/10 rounded-xl shadow-lg text-sm text-gray-200 z-50 overflow-hidden"
              ></div>
            </div>
          </div>

          <!-- <button
            id="searchBtn"
            class="p-2 hover:bg-white/10 rounded-lg transition"
            title="Search"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 text-gray-300 hover:text-[#D4AF37]"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              />
            </svg>
          </button> -->
          <button
            id="cartBtn"
            class="relative p-2 rounded-lg bg-gradient-to-r from-[#D4AF37] to-[#caa530] hover:brightness-110 transition shadow-md"
            title="Cart"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 text-black"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-1.293 2.293a1 1 0 00.707 1.707H17"
              />
            </svg>
            <span
              id="cartCount"
              class="absolute -top-1 -right-1 bg-black text-[#D4AF37] text-[10px] font-bold rounded-full w-4 h-4 flex items-center justify-center"
              >0</span
            >
          </button>
          <button
            id="menuBtn"
            class="p-2 rounded-lg hover:bg-white/10 transition"
            title="Menu"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-6 h-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              />
            </svg>
          </button>
        </div>
      </div>
    </header>

    <script>
      const menuSearchBtn = document.getElementById("menuSearchBtn");
      const searchWrapper = document.getElementById("searchWrapper");
      const searchInput = document.getElementById("searchInput");
      const searchBtn = document.getElementById("searchBtn");
      const closeSearch = document.getElementById("closeSearch");
      const suggestionsBox = document.getElementById("suggestionsBox");

      let searchData = [];
      let debounceTimer;

      // ‚úÖ Load product data
      async function loadSearchData() {
        try {
          const res = await fetch("http://localhost:5000/api/products");
          searchData = await res.json();
        } catch (err) {
          console.error("‚ùå Error loading search data:", err);
        }
      }
      loadSearchData();

      // ‚úÖ Open / Close animations
      function openSearch() {
        searchWrapper.classList.remove("hidden");
        setTimeout(() => {
          searchWrapper.classList.remove("opacity-0", "-translate-y-5");
          searchWrapper.classList.add("opacity-100", "translate-y-0");
          searchInput.focus();
        }, 10);
      }

      function closeSearchBar() {
        searchWrapper.classList.remove("opacity-100", "translate-y-0");
        searchWrapper.classList.add("opacity-0", "-translate-y-5");
        setTimeout(() => {
          searchWrapper.classList.add("hidden");
          suggestionsBox.classList.add("hidden");
          searchInput.value = "";
        }, 400);
      }

      menuSearchBtn?.addEventListener("click", openSearch);
      closeSearch.addEventListener("click", closeSearchBar);

      // ‚úÖ Debounced search for performance
      searchInput.addEventListener("input", () => {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => showSuggestions(), 250);
      });

      function showSuggestions() {
        const query = searchInput.value.trim().toLowerCase();
        if (!query) {
          suggestionsBox.classList.add("hidden");
          return;
        }

        const matches = searchData
          .filter((p) => p.name.toLowerCase().includes(query))
          .slice(0, 6);

        if (matches.length === 0) {
          suggestionsBox.innerHTML = `<div class="px-4 py-3 text-center text-gray-400">No products found</div>`;
          suggestionsBox.classList.remove("hidden");
          return;
        }

        suggestionsBox.innerHTML = matches
          .map(
            (p) => `
          <div class="flex items-center px-4 py-2 hover:bg-white/10 cursor-pointer transition-all">
            <img src="${p.image || "/default.jpg"}" alt="${
              p.name
            }" class="w-10 h-10 object-cover rounded-lg mr-3 border border-white/10" />
            <div class="flex-1">
              <div class="font-medium">${p.name}</div>
              <div class="text-gray-400 text-xs">${p.category || ""}</div>
            </div>
          </div>
        `
          )
          .join("");

        suggestionsBox.classList.remove("hidden");

        // Click to go to product
        Array.from(suggestionsBox.children).forEach((child, i) => {
          child.addEventListener("click", () => {
            searchInput.value = matches[i].name;
            suggestionsBox.classList.add("hidden");
            goToProduct(matches[i]);
          });
        });
      }

      // ‚úÖ Search via Enter key or button
      searchInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          goToSearch();
        }
      });
      searchBtn.addEventListener("click", goToSearch);

      // ‚úÖ Hide suggestions when clicking outside
      document.addEventListener("click", (e) => {
        if (!searchWrapper.contains(e.target)) {
          suggestionsBox.classList.add("hidden");
        }
      });

      // ‚úÖ Redirect to search results page
      function goToSearch() {
        const query = searchInput.value.trim();
        if (query) {
          window.location.href = `products.html?search=${encodeURIComponent(
            query
          )}`;
        }
      }

      // ‚úÖ Go directly to product page (real e-commerce UX)
      function goToProduct(product) {
        if (product._id) {
          window.location.href = `product.html?id=${product._id}`;
        } else {
          goToSearch();
        }
      }
    </script>
    <!-- MOBILE MENU -->
    <div
      id="mobileMenu"
      class="fixed top-0 right-0 w-64 h-full bg-black/95 border-l border-[#D4AF37]/30 shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out z-[60]"
    >
      <div
        class="flex justify-between items-center p-4 border-b border-[#D4AF37]/20"
      >
        <h2 class="text-[#D4AF37] text-lg font-semibold tracking-wide">Menu</h2>
        <button
          id="closeMenu"
          class="text-gray-300 hover:text-[#D4AF37] transition"
        >
          &times;
        </button>
      </div>
      <nav class="flex flex-col p-4 text-gray-300 space-y-4 text-base">
        <a
          href="index.html"
          class="hover:text-[#D4AF37] hover:pl-2 transition-all"
          >Home</a
        >
        <a
          href="products.html"
          class="hover:text-[#D4AF37] hover:pl-2 transition-all"
          >Shop</a
        >
        <a
          href="admin.html"
          class="hover:text-[#D4AF37] hover:pl-2 transition-all"
          >Admin</a
        >
        <a
          href="#anything"
          class="hover:text-[#D4AF37] hover:pl-2 transition-all"
          >Contact</a
        >
        <!-- <hr class="border-t border-[#D4AF37]/20 my-2" /> -->
        <button
          id="authBtn"
          class="gold-btn py-2 rounded-md text-black font-semibold hover:opacity-90 transition"
        >
          Login / Signup
        </button>
        <button
          onclick="toast('Track Order!', { type: 'success' })"
          class="panel py-2 rounded-md text-sm hover:text-[#D4AF37] transition hidden"
        >
          Track Order
        </button>
      </nav>
    </div>

    <!-- AUTH MODAL -->
    <div
      id="authModal"
      class="fixed inset-0 bg-black/70 flex justify-center items-center hidden z-50"
    >
      <div id="authInner" class="panel p-8 relative w-80 max-w-full">
        <button
          onclick="closeAuth()"
          class="absolute top-3 right-3 text-gray-300 hover:text-[#D4AF37] text-xl"
        >
          &times;
        </button>
      </div>
    </div>

    <script>
      const API_URL = "http://localhost:5000/api/auth";

      /* ===== LOGIN / SIGNUP / FORGOT HTML TEMPLATES ===== */
      function loginHTML() {
        return `
          <div class="relative p-4">
            <button type="button"
              class="absolute top-0 right-0 text-gray-400 hover:text-white text-lg font-bold"
              onclick="closeAuth()">‚úñ</button>
            <h3 class="text-xl font-semibold mb-2 text-center gold-text">Login</h3>
            <form id="loginFormPop" class="grid gap-3">
              <input id="popEmail" type="email" placeholder="Email" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
              <div class="relative">
                <input id="popPw" type="password" placeholder="Password" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
                <button type="button" id="showLoginPw" class="absolute right-3 top-3 text-sm text-gray-300">Show</button>
              </div>
              <button type="submit" class="gold-btn py-2 rounded-md">Sign In</button>
            </form>
            <div class="text-sm mt-2 flex justify-between">
              <button id="toSignupFromLogin" type="button" class="text-[var(--gold)] underline">Create account</button>
              <button id="toForgotFromLogin" type="button" class="text-gray-400 underline">Forgot?</button>
            </div>
          </div>
        `;
      }

      function signupHTML() {
        return `
          <div class="relative p-4">
            <button type="button"
              class="absolute top-0 right-0 text-gray-400 hover:text-white text-lg font-bold"
              onclick="closeAuth()">‚úñ</button>
            <h3 class="text-xl font-semibold mb-2 text-center gold-text">Create account</h3>
            <form id="signupFormPop" class="grid gap-3">
              <input id="popName" placeholder="Full name" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
              <input id="popEmailS" type="email" placeholder="Email" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
              <input id="popMobile" placeholder="Mobile number (10 digits)" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
              <div class="relative">
                <input id="popPwS" type="password" placeholder="Password (min 8 chars)" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
                <button type="button" id="showSignupPw" class="absolute right-3 top-3 text-sm text-gray-300">Show</button>
              </div>
              <div class="relative">
                <input id="popPwS2" type="password" placeholder="Confirm password" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
                <button type="button" id="showSignupPw2" class="absolute right-3 top-3 text-sm text-gray-300">Show</button>
              </div>
              <button type="submit" class="gold-btn py-2 rounded-md">Create Account</button>
            </form>
            <div class="text-sm mt-2 text-center">
              <button id="toLoginFromSignup" type="button" class="text-gray-400 underline">Already have an account? Sign in</button>
            </div>
          </div>
        `;
      }

      function forgotHTML() {
        return `
          <div class="relative p-4">
            <button type="button"
              class="absolute top-0 right-0 text-gray-400 hover:text-white text-lg font-bold"
              onclick="closeAuth()">‚úñ</button>
            <h3 class="text-xl font-semibold mb-2 text-center gold-text">Reset password</h3>
            <form id="forgotFormPop" class="grid gap-3">
              <input id="popForgotEmail" type="email" placeholder="Registered email" class="p-3 rounded-md bg-transparent border border-white/10 w-full" required />
              <button type="submit" class="gold-btn py-2 rounded-md">Send Reset Link</button>
            </form>
            <div class="text-sm mt-2 text-center">
              <button id="toLoginFromForgot" type="button" class="text-gray-400 underline">Back to sign in</button>
            </div>
          </div>
        `;
      }

      /* ===== SHOW MODAL ===== */
      function openAuth(mode = "login") {
        document.getElementById("authModal").classList.remove("hidden");
        if (mode === "login") showLoginModal();
        if (mode === "signup") showSignupModal();
        if (mode === "forgot") showForgotModal();
      }

      function closeAuth() {
        document.getElementById("authModal").classList.add("hidden");
      }

      /* ===== LOGIN MODAL ===== */
      function showLoginModal() {
        const authInner = document.getElementById("authInner");
        authInner.innerHTML = loginHTML();

        // Password toggle
        document.getElementById("showLoginPw").addEventListener("click", () => {
          const pw = document.getElementById("popPw");
          pw.type = pw.type === "password" ? "text" : "password";
        });

        // Form submit
        document
          .getElementById("loginFormPop")
          .addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document.getElementById("popEmail").value.trim();
            const password = document.getElementById("popPw").value.trim();
            if (!email || !password)
              return toast("‚ùå Email and password are required.", {
                type: "error",
              });

            let data; // ‚úÖ define outside try block

            try {
              const res = await fetch(`${API_URL}/login`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, password }),
              });

              const text = await res.text();
              try {
                data = JSON.parse(text);
              } catch {
                console.error("‚ùå Invalid JSON:", text);
                throw new Error("Server returned invalid JSON");
              }

              if (!res.ok) throw new Error(data.message || "Login failed");

              // Save JWT and user info
              localStorage.setItem("user", JSON.stringify(data.user));
              localStorage.setItem("token", data.token);

              // call from buynow producthtml
              const params = new URLSearchParams(window.location.search);
              const authMode = params.get("auth");
              if (authMode) {
                openAuth(authMode);
              }
              closeAuth();
              updateUserUI();
              toast("‚úÖ " + data.message, { type: "success" });

              if (data.user.role === "admin")
                window.location.href = "admin.html";
            } catch (err) {
              // ‚úÖ use optional chaining so it doesn‚Äôt crash
              toast("‚ùå " + (data?.message || err.message), { type: "error" });
              console.error(err);
            }
          });

        // Switch modals
        document
          .getElementById("toSignupFromLogin")
          .addEventListener("click", showSignupModal);
        document
          .getElementById("toForgotFromLogin")
          .addEventListener("click", showForgotModal);
      }

      /* ===== SIGNUP MODAL ===== */
      function showSignupModal() {
        const authInner = document.getElementById("authInner");
        authInner.innerHTML = signupHTML();

        // Password toggles
        document
          .getElementById("showSignupPw")
          .addEventListener("click", () => {
            const pw = document.getElementById("popPwS");
            pw.type = pw.type === "password" ? "text" : "password";
          });
        document
          .getElementById("showSignupPw2")
          .addEventListener("click", () => {
            const pw = document.getElementById("popPwS2");
            pw.type = pw.type === "password" ? "text" : "password";
          });

        document
          .getElementById("signupFormPop")
          .addEventListener("submit", async (e) => {
            e.preventDefault();
            const name = document.getElementById("popName").value.trim();
            const email = document.getElementById("popEmailS").value.trim();
            const mobile = document.getElementById("popMobile").value.trim();
            const pw = document.getElementById("popPwS").value;
            const pw2 = document.getElementById("popPwS2").value;
            if (!name || !email || !mobile || !pw || !pw2)
              return toast("Please fill all fields.", { type: "warning" });
            if (pw !== pw2)
              return toast("Passwords do not match!", { type: "error" });

            try {
              const res = await fetch(`${API_URL}/register`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name, email, mobile, password: pw }),
              });
              const data = await res.json();
              if (!res.ok) throw new Error(data.message || "Signup failed");

              toast("‚úÖ Account created successfully!", { type: "success" });
              showLoginModal();
            } catch (err) {
              toast("‚ùå " + err.message, { type: "error" });
              console.error(err);
            }
          });

        document
          .getElementById("toLoginFromSignup")
          .addEventListener("click", showLoginModal);
      }

      /* ===== FORGOT MODAL ===== */
      function showForgotModal() {
        const authInner = document.getElementById("authInner");
        authInner.innerHTML = forgotHTML(); // dynamic HTML

        document
          .getElementById("forgotFormPop")
          .addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document
              .getElementById("popForgotEmail")
              .value.trim();
            if (!email)
              return toast("Please enter your registered email.", {
                type: "error",
              });

            try {
              const res = await fetch(`${API_URL}/forgot`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email }),
              });
              const data = await res.json();
              if (!res.ok) throw new Error(data.message || "Failed");

              toast("‚úÖ " + data.message, { type: "success" });
              showLoginModal(); // go back to login
            } catch (err) {
              toast("‚ùå " + err.message, { type: "error" });
              console.error(err);
            }
          });

        document
          .getElementById("toLoginFromForgot")
          .addEventListener("click", showLoginModal);
      }

      /* ===== UPDATE MENU WITH USER ===== */
      function updateUserUI() {
        const menu = document.getElementById("mobileMenu");
        if (!menu) return setTimeout(updateUserUI, 100);

        const authBtn = document.getElementById("authBtn");
        const user = JSON.parse(localStorage.getItem("user"));
        const existing = document.getElementById("userBox");
        const existingLogout = document.getElementById("logoutSection");

        if (existing) existing.remove();
        if (existingLogout) existingLogout.remove();

        const nav = menu.querySelector("nav");

        document.getElementById("checkoutBtn").addEventListener("click", () => {
          if (!user) {
            openAuth();
          }
          window.location.href = "order1.html";
        });

        if (user) {
          if (authBtn) authBtn.style.display = "none";

          // Remove existing user box & logout if they exist (to avoid duplicates)
          document.getElementById("userBox")?.remove();
          document.getElementById("logoutSection")?.remove();

          // Create user welcome box (top)
          const userBox = document.createElement("div");
          userBox.id = "userBox";
          userBox.className =
            "flex items-center justify-between border-b border-[#D4AF37]/20 pb-3 mb-3";

          userBox.innerHTML = `
          <div class="flex items-center space-x-3">
            <img src="${
              user.avatar ||
              "https://cdn-icons-png.flaticon.com/512/847/847969.png"
            }"
              alt="User Avatar"
              class="w-10 h-10 rounded-full border border-[#D4AF37]/30 object-cover" />
            <div>
              <p class="text-[#D4AF37] text-sm font-semibold">üëã Welcome, ${
                user.name
              }</p>
              ${
                user.role === "admin"
                  ? `<p class="text-[10px] text-red-400 font-semibold">[ADMIN]</p>`
                  : ""
              }
            </div>
          </div>
        `;

          // Insert at top of <nav>
          nav.prepend(userBox);

          // ===== Admin-specific actions =====
          const adminLink = document.querySelector('a[href="admin.html"]');
          if (user.role === "admin") {
            if (adminLink) adminLink.style.display = "block";
          } else {
            if (adminLink) adminLink.style.display = "none";
          }

          // ===== Logout section =====
          const logoutDiv = document.createElement("div");
          logoutDiv.id = "logoutSection";
          logoutDiv.className =
            "flex justify-center mt-4 border-t border-[#D4AF37]/20 pt-3";
          logoutDiv.innerHTML = `
          <button id="logoutBtn"
            class="px-4 py-2 w-full bg-[#D4AF37]/10 text-[#D4AF37] text-sm rounded-lg border border-[#D4AF37]/30 hover:bg-[#D4AF37]/20 hover:text-white transition duration-200">
            Logout
          </button>
        `;
          nav.appendChild(logoutDiv);

          // ===== Logout functionality =====
          document.getElementById("logoutBtn").addEventListener("click", () => {
            localStorage.removeItem("user");
            localStorage.removeItem("token");
            updateUserUI();
            toast("You‚Äôve been logged out.", { type: "info" });
          });
        } else {
          // If no user logged in
          if (authBtn) authBtn.style.display = "block";

          // Hide admin link from guests
          const adminLink = document.querySelector('a[href="admin.html"]');
          if (adminLink) adminLink.style.display = "none";
        }
      }

      /* ===== INIT ===== */
      document.addEventListener("DOMContentLoaded", () => {
        updateUserUI();
        document
          .getElementById("authBtn")
          .addEventListener("click", () => openAuth("login"));
      });
    </script>

    <!-- MOBILE MENU -->
    <!-- <div id="mobileMenu" class="fixed inset-0 z-40 hidden" aria-hidden="true">
    <div class="absolute inset-0 bg-black/60" onclick="toggleMobileMenu()" aria-hidden="true"></div>
    <aside class="absolute top-0 right-0 w-4/5 max-w-sm h-full panel p-6 overflow-auto" role="dialog" aria-modal="true" aria-label="Mobile menu">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-3">
          <div class="logo-panel p-1"><img src="images/logo.jpg" alt="logo" onerror="this.src=logoFallback()" class="w-full h-full object-contain rounded-md"></div>
          <div>
            <div class="font-semibold">Vibrant Flight</div>
            <div class="text-xs text-gray-400">Elevate Your Journey</div>
          </div>
        </div>
        <button class="mb-4 text-gray-300" onclick="toggleMobileMenu()" aria-label="Close menu">‚úï</button>
      </div>

      <nav class="flex flex-col gap-3" aria-label="Mobile navigation">
        <a href="#shop" class="py-2">Shop</a>
        <a href="#offers" class="py-2">Offers</a>
        <a href="#about" class="py-2">About</a>
        <a href="#contact" class="py-2">Contact</a>
        <a href="#testimonials" class="py-2">Testimonials</a>

        <div class="mt-4">
          <button class="gold-btn w-full py-2 mb-2" onclick="openAuth('login')">Login / Signup</button>
          <button class="panel w-full py-2" onclick="openTrackMobile()">Track Order</button>
        </div>

        <div class="mt-6">
          <div class="text-xs text-gray-400">Follow us</div>
          <div class="flex gap-2 mt-2">
            <div class="panel w-10 h-10 flex items-center justify-center rounded-full">ig</div>
            <div class="panel w-10 h-10 flex items-center justify-center rounded-full">fb</div>
            <div class="panel w-10 h-10 flex items-center justify-center rounded-full">yt</div>
          </div>
        </div>
      </nav>
    </aside>
  </div> -->

    <!-- COLLECTIONS MENU -->
    <div id="collectionsMenu" class="hidden max-w-screen-xl mx-auto px-4 mt-2">
      <div class="panel p-4 rounded-xl grid grid-cols-1 sm:grid-cols-4 gap-4">
        <a class="flex gap-3 items-center p-3 rounded-lg" href="#tshirts">
          <img
            src="https://images.unsplash.com/photo-1520975910683-9f1ddf7e0b8a?auto=format&fit=crop&w=160&q=60"
            class="w-20 h-20 rounded-lg object-cover"
          />
          <div>
            <div class="font-semibold">T-Shirts</div>
            <div class="text-xs text-gray-400">Daily essentials</div>
          </div>
        </a>
        <a class="flex gap-3 items-center p-3 rounded-lg" href="#shirts">
          <img
            src="https://images.unsplash.com/photo-1465381760095-69bdbde6a1c1?auto=format&fit=crop&w=160&q=60"
            class="w-20 h-20 rounded-lg object-cover"
          />
          <div>
            <div class="font-semibold">Shirts</div>
            <div class="text-xs text-gray-400">Smart & casual</div>
          </div>
        </a>
        <a class="flex gap-3 items-center p-3 rounded-lg" href="#bottoms">
          <img
            src="https://images.unsplash.com/photo-1541099649105-f69ad21f3246?auto=format&fit=crop&w=160&q=60"
            class="w-20 h-20 rounded-lg object-cover"
          />
          <div>
            <div class="font-semibold">Bottoms</div>
            <div class="text-xs text-gray-400">Jeans, chinos</div>
          </div>
        </a>
        <a class="flex gap-3 items-center p-3 rounded-lg" href="#accessories">
          <img
            src="https://images.unsplash.com/photo-1519744792095-2f2205e87b6f?auto=format&fit=crop&w=160&q=60"
            class="w-20 h-20 rounded-lg object-cover"
          />
          <div>
            <div class="font-semibold">Accessories</div>
            <div class="text-xs text-gray-400">Caps & more</div>
          </div>
        </a>
      </div>
    </div>

    <main class="max-w-screen-xl mx-auto px-4 mt-6 pb-20 relative">
      <div id="reflect" class="reflect" aria-hidden="true"></div>

      <!-- HERO --><!-- HERO CAROUSEL -->
      <section
        id="heroCarousel"
        class="relative w-full overflow-hidden rounded-2xl mt-4"
      >
        <!-- Slide 1 -->
        <div class="carousel-slide active">
          <a href="./products.html">
            <img
              src="/images/f9.jpg"
              alt="Vibrant Flight Collection"
              class="w-full h-[500px] object-cover cursor-pointer"
            />
          </a>
        </div>

        <!-- Slide 2 -->
        <div class="carousel-slide">
          <a href="./products.html">
            <img
              src="/images/f11.jpg"
              alt="Streetwear Collection"
              class="w-full h-[500px] object-cover cursor-pointer"
            />
          </a>
        </div>

        <!-- Slide 3 -->
        <div class="carousel-slide">
          <a href="./products.html">
            <img
              src="/images/f9.jpg"
              alt="Modern Style"
              class="w-full h-[500px] object-cover cursor-pointer"
            />
          </a>
        </div>

        <!-- Dots -->
        <div
          id="carouselDots"
          class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-10"
        >
          <span
            class="dot w-3 h-3 rounded-full bg-gray-400 cursor-pointer"
          ></span>
          <span
            class="dot w-3 h-3 rounded-full bg-gray-400 cursor-pointer"
          ></span>
          <span
            class="dot w-3 h-3 rounded-full bg-gray-400 cursor-pointer"
          ></span>
        </div>
      </section>

      <!-- NEW DROP / ANNOUNCEMENT -->
      <section class="mt-8 text-center">
        <div class="panel inline-block px-6 py-3">
          <span class="font-semibold gold-text">DROP II LIVE NOW</span>
          <a href="./products.html" class="ml-4 underline">View All</a>
        </div>
      </section>

      <!-- CATEGORY ROW -->
      <!-- ================= CATEGORY GRID ================= -->
      <section id="categories" class="mt-12">
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-6">
          <!-- T-Shirts -->
          <a
            href="products.html?category=tshirt"
            class="group flex flex-col items-center text-center cursor-pointer transition-transform hover:scale-105"
          >
            <div
              class="w-24 h-24 rounded-full overflow-hidden border-2 border-[#D4AF37] shadow-md"
            >
              <img
                src="https://assets.ajio.com/medias/sys_master/root/20240920/wv4r/66ed61ec260f9c41e8173c64/-473Wx593H-700412130-white-MODEL.jpg"
                alt="T-Shirts"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </div>
            <small class="mt-2 text-sm text-gray-300 group-hover:text-[#D4AF37]"
              >T-Shirts</small
            >
          </a>

          <!-- Shirts -->
          <a
            href="products.html?category=shirt"
            class="group flex flex-col items-center text-center cursor-pointer transition-transform hover:scale-105"
          >
            <div
              class="w-24 h-24 rounded-full overflow-hidden border-2 border-[#D4AF37] shadow-md"
            >
              <img
                src="https://cottonfolk.in/cdn/shop/files/Cloud_Coal_Collection.jpg?v=1746078017&width=2048"
                alt="Shirts"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </div>
            <small class="mt-2 text-sm text-gray-300 group-hover:text-[#D4AF37]"
              >Shirts</small
            >
          </a>

          <!-- Hoodies -->
          <a
            href="products.html?category=hoodie"
            class="group flex flex-col items-center text-center cursor-pointer transition-transform hover:scale-105"
          >
            <div
              class="w-24 h-24 rounded-full overflow-hidden border-2 border-[#D4AF37] shadow-md"
            >
              <img
                src="https://veirdo.in/cdn/shop/files/Anger_Green_Oversized_Pocket_Graphic_Printed_Hoodie.jpg?v=1754544896"
                alt="Hoodies"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </div>
            <small class="mt-2 text-sm text-gray-300 group-hover:text-[#D4AF37]"
              >Hoodies</small
            >
          </a>

          <!-- Sweatshirts -->
          <a
            href="products.html?category=sweatshirt"
            class="group flex flex-col items-center text-center cursor-pointer transition-transform hover:scale-105"
          >
            <div
              class="w-24 h-24 rounded-full overflow-hidden border-2 border-[#D4AF37] shadow-md"
            >
              <img
                src="https://cdn.shopify.com/s/files/1/0623/7916/3734/files/70e889af_b91a_700x.jpg?v=1757611986"
                alt="Sweatshirts"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </div>
            <small class="mt-2 text-sm text-gray-300 group-hover:text-[#D4AF37]"
              >Sweatshirts</small
            >
          </a>

          <!-- Oversized T‚Äôs -->
          <a
            href="products.html?category=oversized"
            class="group flex flex-col items-center text-center cursor-pointer transition-transform hover:scale-105"
          >
            <div
              class="w-24 h-24 rounded-full overflow-hidden border-2 border-[#D4AF37] shadow-md"
            >
              <img
                src="https://i0.wp.com/printrove.com/wp-content/uploads/2025/07/front-6843e633117d7-Ash_Grey_M_Premium_Oversized_T-shirt.jpg?fit=1500%2C1500&ssl=1"
                alt="Oversized T‚Äôs"
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
              />
            </div>
            <small class="mt-2 text-sm text-gray-300 group-hover:text-[#D4AF37]"
              >Oversized T‚Äôs</small
            >
          </a>
        </div>
      </section>

      <!-- FILTER BAR -->
      <!-- FILTER BAR -->
      <section class="mt-6 flex flex-wrap gap-3 justify-between items-center">
        <!-- Left filters -->
        <div class="flex gap-3 flex-wrap">
          <div
            class="panel px-2 py-1 rounded-md text-sm bg-white text-gray-800 flex items-center"
          >
            Category:
            <select
              id="filterCategory"
              class="bg-transparent outline-none ml-1 text-sm text-gray-800"
            >
              <option value="">All</option>
              <option value="tshirt">T-Shirts</option>
              <option value="shirt">Shirts</option>
              <option value="jeans">Jeans</option>
              <option value="chinos">Chinos</option>
              <option value="accessory">Accessory</option>
            </select>
          </div>

          <div
            class="panel px-2 py-1 rounded-md text-sm bg-white text-gray-800 flex items-center"
          >
            Sort:
            <select
              id="sortBy"
              class="bg-transparent outline-none ml-1 text-sm text-gray-800"
            >
              <option value="featured">Featured</option>
              <option value="price-asc">Price: Low ‚Üí High</option>
              <option value="price-desc">Price: High ‚Üí Low</option>
            </select>
          </div>
        </div>

        <!-- Right filters -->
        <div class="flex gap-3 flex-wrap items-center">
          <div class="text-sm text-gray-300">
            Showing <span id="showCount">0</span> products
          </div>
          <div
            class="panel px-2 py-1 rounded-md text-sm bg-white text-gray-800 flex items-center"
          >
            Price:
            <select
              id="priceFilter"
              class="bg-transparent ml-1 text-gray-800 text-sm"
            >
              <option value="any">All</option>
              <option value="0-699">Under ‚Çπ699</option>
              <option value="700-999">‚Çπ700 - ‚Çπ999</option>
              <option value="1000-9999">‚Çπ1000+</option>
            </select>
          </div>
        </div>
      </section>

      <!-- PRODUCTS GRID -->
      <div
        id="productsGrid"
        class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-5 mt-4"
      ></div>

      <script>
        const productsGrid = document.getElementById("productsGrid");
        const showCount = document.getElementById("showCount");
        const categoryFilter = document.getElementById("filterCategory");
        const priceFilter = document.getElementById("priceFilter");
        const sortBy = document.getElementById("sortBy");

        let allProducts = [];

        // ‚úÖ Fetch products from backend
        async function fetchProducts() {
          try {
            const res = await fetch("http://localhost:5000/api/products");
            allProducts = await res.json();
            renderProducts();
          } catch (err) {
            console.error("Error fetching products:", err);
          }
        }

        // ‚úÖ Render products dynamically
        function renderProducts() {
          let filtered = [...allProducts];

          // Filter by category
          const cat = categoryFilter.value;
          if (cat)
            filtered = filtered.filter(
              (p) => p.category.toLowerCase() === cat.toLowerCase()
            );

          // Filter by price
          const price = priceFilter.value;
          if (price !== "any") {
            const [min, max] = price.split("-").map(Number);
            filtered = filtered.filter(
              (p) => p.price >= min && (max ? p.price <= max : true)
            );
          }

          // Sort
          if (sortBy.value === "price-asc")
            filtered.sort((a, b) => a.price - b.price);
          if (sortBy.value === "price-desc")
            filtered.sort((a, b) => b.price - a.price);

          // Update count
          showCount.textContent = filtered.length;

          // Render
          productsGrid.innerHTML = filtered.length
            ? filtered
                .map(
                  (p) => `
        <div class="glass rounded-xl overflow-hidden hover:scale-105 transition transform duration-300 flex flex-col justify-between min-h-[420px]">
          <a href="product.html?id=${p._id}">
          <img src="${p.img}" alt="${
                    p.name
                  }" class="w-full h-56 object-cover" />
          </a>
          <div class="p-3">
         
            <h3 class="font-semibold text-lg">${p.name}</h3>
            <p class="text-gray-400 text-sm line-clamp-2">${p.desc}</p>
            <div class="flex items-center justify-between mt-2">
              <span class="text-yellow-400 font-bold text-lg">‚Çπ${p.price}</span>
              ${
                p.old
                  ? `<span class="text-gray-500 line-through text-sm">‚Çπ${p.old}</span>`
                  : ""
              }
            </div>
          </div>
          <button
    class="addToCartBtn mt-2 w-full py-2 bg-yellow-400 hover:bg-yellow-500 rounded-md font-semibold"
    data-id="${p._id}"
  >
    Add to Cart
  </button>
        </div>
      `
                )
                .join("")
            : `<p class="text-gray-400 col-span-full text-center">No products found.</p>`;
        }

        // ‚úÖ Event listeners
        categoryFilter.addEventListener("change", renderProducts);
        priceFilter.addEventListener("change", renderProducts);
        sortBy.addEventListener("change", renderProducts);

        // Initial load
        fetchProducts();
      </script>

      <script>
        const API_CART = "http://localhost:5000/api/cart";

        // üß≠ Fetch user's cart from DB on page load
        async function fetchCart() {
          const token = localStorage.getItem("token");
          if (!token) return;

          try {
            const res = await fetch(API_CART, {
              headers: { Authorization: `Bearer ${token}` },
            });

            const data = await res.json();

            if (res.ok && data.cart) {
              updateCartUI(data.cart);
            } else {
              updateCartUI({ items: [] });
            }
          } catch (err) {
            console.error("Fetch cart error:", err);
            updateCartUI({ items: [] });
          }
        }

        // ‚ûï Add product to cart (database-backed)
        async function addToCart(productId, quantity = 1) {
          const token = localStorage.getItem("token");
          if (!token)
            return toast("‚ö†Ô∏è Please login to continue", { type: "warning" });

          try {
            const res = await fetch(API_CART, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
              body: JSON.stringify({ productId, quantity }),
            });

            const data = await res.json();

            if (res.ok) {
              updateCartUI(data.cart);
              toast("‚úÖ Product added to cart!", { type: "success" });
            } else {
              toast(data.message || "‚ùå Failed to add to cart", {
                type: "error",
              });
            }
          } catch (err) {
            console.error("Add to cart error:", err);
            toast("‚ö†Ô∏è Server error: Failed to add to cart", { type: "error" });
          }
        }

        // ‚ùå Remove product from cart (database-backed)
        async function removeFromCart(productId) {
          const token = localStorage.getItem("token");
          if (!token)
            return toast("‚ö†Ô∏è Please login to remove items", {
              type: "warning",
            });

          try {
            const res = await fetch(`${API_CART}/${productId}`, {
              method: "DELETE",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
            });

            const data = await res.json();

            if (!res.ok) {
              console.error("Remove cart item error:", data);
              return toast(data.message || "‚ùå Failed to remove item", {
                type: "error",
              });
            }

            if (data.cart && data.cart.items) {
              updateCartUI(data.cart);
              toast("üóëÔ∏è Item removed from cart", { type: "success" });
            } else {
              updateCartUI({ items: [] });
              toast("üóëÔ∏è Item removed. Cart is now empty", { type: "info" });
            }
          } catch (err) {
            console.error("Remove item error:", err);
            toast("‚ö†Ô∏è Server error: Unable to remove item", { type: "error" });
          }
        }

        // üßπ Clear the entire cart (database-backed)
        async function clearCart() {
          const token = localStorage.getItem("token");
          if (!token)
            return toast("‚ö†Ô∏è Please login to clear your cart", {
              type: "warning",
            });

          if (!confirm("Are you sure you want to clear your cart?")) return;

          try {
            const res = await fetch(API_CART, {
              method: "DELETE",
              headers: { Authorization: `Bearer ${token}` },
            });

            const data = await res.json();

            if (!res.ok) {
              return toast(data.message || "‚ùå Failed to clear cart", {
                type: "error",
              });
            }

            updateCartUI(data.cart);
            toast("üßπ Cart cleared successfully!", { type: "success" });
          } catch (err) {
            console.error("Clear cart error:", err);
            toast("‚ö†Ô∏è Server error: Unable to clear cart", { type: "error" });
          }
        }

        // üõí Update cart sidebar UI + badge count
        function updateCartUI(cart) {
          const container = document.getElementById("cartItems");
          const subtotalEl = document.getElementById("cartSub");
          const checkoutBtn = document.getElementById("checkoutBtn");
          const cartCountEl = document.getElementById("cartCount");

          if (!cart || !cart.items || cart.items.length === 0) {
            if (container)
              container.innerHTML = `<p class="text-gray-400 text-center">Cart is empty</p>`;
            if (subtotalEl) subtotalEl.textContent = "‚Çπ0";
            if (checkoutBtn) checkoutBtn.disabled = true;
            if (cartCountEl) cartCountEl.textContent = "0";
            return;
          }

          if (checkoutBtn) checkoutBtn.disabled = false;

          if (cartCountEl) {
            const totalItems = cart.items.reduce(
              (sum, item) => sum + item.quantity,
              0
            );
            cartCountEl.textContent = totalItems;
          }

          let subtotal = 0;

          if (container) {
            container.innerHTML = cart.items
              .map(
                (item) => `
        <div class="flex items-center justify-between mb-3" data-id="${
          item.product._id
        }">
          <div class="flex items-center gap-2">
            <img src="${
              item.product.img
            }" class="w-12 h-12 object-cover rounded" />
            <div>
              <h5 class="font-semibold text-sm">${item.product.name}</h5>
              <p class="text-gray-400 text-xs">Qty: ${item.quantity}</p>
            </div>
          </div>
          <div class="flex flex-col items-end gap-1">
            <span class="font-semibold">‚Çπ${(
              item.product.price * item.quantity
            ).toFixed(2)}</span>
            <button class="removeItemBtn text-red-500 text-xs hover:underline">Remove</button>
          </div>
        </div>
      `
              )
              .join("");
          }

          subtotal = cart.items.reduce(
            (sum, item) => sum + item.product.price * item.quantity,
            0
          );
          if (subtotalEl) subtotalEl.textContent = `‚Çπ${subtotal.toFixed(2)}`;

          if (container) {
            container.querySelectorAll(".removeItemBtn").forEach((btn) => {
              btn.onclick = () => {
                const productId = btn.closest("[data-id]").dataset.id;
                removeFromCart(productId);
              };
            });
          }
        }

        // üõçÔ∏è Add to Cart button listener
        document.addEventListener("click", (e) => {
          if (e.target.classList.contains("addToCartBtn")) {
            addToCart(e.target.dataset.id, 1);
          }
        });

        // üßπ Attach Clear Cart button and fetch cart on load
        document.addEventListener("DOMContentLoaded", () => {
          const clearBtn = document.getElementById("clearCart");
          if (clearBtn) clearBtn.addEventListener("click", clearCart);
          fetchCart();
        });
      </script>

      <!-- OFFERS / BUNDLES -->
      <!-- <section id="offers" class="mt-10 grid md:grid-cols-3 gap-4">
      <div class="panel p-5 rounded-xl text-center">
        <div class="text-sm text-gray-400">T-shirt + Jeans Combo</div>
        <div class="text-2xl font-bold gold-text mt-1">‚Çπ2,299</div>
      </div>
      <div class="panel p-5 rounded-xl text-center">
        <div class="text-sm text-gray-400">Shirt + Chinos Set</div>
        <div class="text-2xl font-bold gold-text mt-1">‚Çπ2,699</div>
      </div>
      <div class="panel p-5 rounded-xl text-center">
        <div class="text-sm text-gray-400">Hoodie + Cap Bundle</div>
        <div class="text-2xl font-bold gold-text mt-1">‚Çπ2,499</div>
      </div>
    </section> -->

      <!-- ABOUT & FEATURES -->
      <section id="about" class="mt-10 grid md:grid-cols-2 gap-6">
        <div class="panel p-6 rounded-2xl">
          <h3 class="text-2xl font-bold gold-text">About Vibrant Flight</h3>
          <p class="text-gray-300 mt-2">
            We source premium clothing and accessories with a focus on design,
            durability and user experience.
          </p>
          <ul class="mt-4 space-y-2 text-sm text-gray-300">
            <li>‚Ä¢ Official store warranty</li>
            <li>‚Ä¢ Premium packaging</li>
            <li>‚Ä¢ 7-day return policy</li>
          </ul>
        </div>
        <div class="panel p-6 rounded-2xl">
          <h4 class="text-xl font-semibold gold-text">Why choose us</h4>
          <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
            <div class="panel p-3 rounded-lg">
              <div class="font-semibold">Genuine Products</div>
              <div class="text-xs text-gray-300">
                Direct from verified vendors.
              </div>
            </div>
            <div class="panel p-3 rounded-lg">
              <div class="font-semibold">Secure Payments</div>
              <div class="text-xs text-gray-300">
                Encrypted payments & multiple options.
              </div>
            </div>
            <div class="panel p-3 rounded-lg">
              <div class="font-semibold">Fast Delivery</div>
              <div class="text-xs text-gray-300">
                Priority shipping available.
              </div>
            </div>
            <div class="panel p-3 rounded-lg">
              <div class="font-semibold">Customer Support</div>
              <div class="text-xs text-gray-300">
                24/7 support for premium orders.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- CONTACT SECTION -->
      <section id="anything" class="mt-12 panel p-8 rounded-2xl">
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold gold-text">Anything Else?</h3>
          <p class="text-gray-300">Let us know & we‚Äôll assist you</p>
        </div>
        <form id="anythingForm" class="max-w-xl mx-auto grid gap-4">
          <input
            name="name"
            type="text"
            class="p-3 rounded-md bg-transparent border border-white/10 text-sm"
            placeholder="Your Name"
            required
          />
          <input
            name="email"
            type="email"
            class="p-3 rounded-md bg-transparent border border-white/10 text-sm"
            placeholder="Your Email"
            required
          />
          <input
            name="phone"
            type="tel"
            class="p-3 rounded-md bg-transparent border border-white/10 text-sm"
            placeholder="Phone (optional)"
          />
          <textarea
            name="message"
            rows="3"
            class="p-3 rounded-md bg-transparent border border-white/10 text-sm"
            placeholder="Your Message"
            required
          ></textarea>
          <button type="submit" class="gold-btn py-2 rounded-md">
            Send Message
          </button>
        </form>
      </section>

      <script>
        const CONTACT_API = "http://localhost:5000/api/contact";

        document
          .getElementById("anythingForm")
          .addEventListener("submit", async (e) => {
            e.preventDefault();

            const form = e.target;
            const formData = {
              name: form.name.value.trim(),
              email: form.email.value.trim(),
              phone: form.phone.value.trim(),
              message: form.message.value.trim(),
            };

            if (!formData.name || !formData.email || !formData.message) {
              return toast("Please fill in all required fields.", {
                type: "warning",
              });
            }

            try {
              const res = await fetch(CONTACT_API, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(formData),
              });

              const data = await res.json();

              if (!res.ok) {
                return toast(data.message || "Failed to send message", {
                  type: "info",
                });
              }

              toast("‚úÖ Message sent successfully!", { type: "success" });
              form.reset();
            } catch (err) {
              console.error("Send message error:", err);
              toast("‚ùå Server error. Please try again later.", {
                type: "error",
              });
            }
          });
      </script>

      <!-- TESTIMONIALS -->
      <section id="testimonials" class="mt-10">
        <div class="grid md:grid-cols-3 gap-4">
          <div class="panel p-6 rounded-xl">
            <div class="text-6xl text-white/10">‚Äú</div>
            <div class="mt-2">
              The premium cloth was worth every rupee ‚Äî packaging & delivery
              were superb.
            </div>
            <div class="mt-4 text-sm text-gray-400">‚Äî Rohan</div>
          </div>
          <div class="panel p-6 rounded-xl">
            <div class="text-6xl text-white/10">‚Äú</div>
            <div class="mt-2">
              Customer service helped me through setup and warranty
              registration.
            </div>
            <div class="mt-4 text-sm text-gray-400">‚Äî Priya</div>
          </div>
          <div class="panel p-6 rounded-xl">
            <div class="text-6xl text-white/10">‚Äú</div>
            <div class="mt-2">
              Fast shipping and genuine accessories. Highly trustworthy.
            </div>
            <div class="mt-4 text-sm text-gray-400">‚Äî Salman</div>
          </div>
        </div>
      </section>

      <!-- NEWSLETTER -->
      <section class="mt-10 panel p-6 rounded-xl">
        <div
          class="flex flex-col md:flex-row md:items-center md:justify-between gap-4"
        >
          <div>
            <div class="font-semibold">Join our newsletter</div>
            <div class="text-sm text-gray-300">
              Get early access to drops & exclusive offers.
            </div>
          </div>
          <form id="newsletterForm" class="flex gap-2">
            <input
              id="newsletterEmail"
              type="email"
              required
              placeholder="Your email"
              class="p-2 rounded-md bg-transparent border border-white/10"
            />
            <button class="gold-btn px-4 py-2 rounded-md">Subscribe</button>
          </form>
        </div>
      </section>

      <!-- FOOTER -->
      <footer class="max-w-screen-xl mx-auto px-4 mt-12 pb-12 text-gray-400">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <div class="text-lg font-semibold gold-text">Vibrant Flight</div>
            <div class="text-sm italic">Elevate Your Journey</div>
            <p class="text-sm mt-3 text-gray-400">
              Premium clothing & accessories ‚Äî curated essentials & seasonal
              drops.
            </p>
          </div>
          <div>
            <div class="font-semibold mb-2">Customer</div>
            <ul class="text-sm space-y-1">
              <li><a href="#" class="hover:underline">Track Order</a></li>
              <li><a href="#" class="hover:underline">Returns & Refund</a></li>
              <li><a href="#" class="hover:underline">Shipping Policy</a></li>
              <li><a href="#" class="hover:underline">Warranty</a></li>
            </ul>
          </div>
          <div>
            <div class="font-semibold mb-2">Contact</div>
            <div class="text-sm">hello@vibrantflight.com</div>
            <div class="mt-2 text-sm">Follow</div>
            <div class="flex gap-2 mt-2">
              <div
                class="panel w-10 h-10 flex items-center justify-center rounded-full"
              >
                ig
              </div>
              <div
                class="panel w-10 h-10 flex items-center justify-center rounded-full"
              >
                fb
              </div>
              <div
                class="panel w-10 h-10 flex items-center justify-center rounded-full"
              >
                yt
              </div>
            </div>
          </div>
        </div>
        <div class="mt-8 text-xs text-gray-500 text-center">
          ¬© 2025 Vibrant Flight ‚Äî All rights reserved ¬∑
          <a href="#" class="hover:underline">Privacy Policy</a> ¬∑
          <a href="#" class="hover:underline">Refund Policy</a> ¬∑
          <a href="#" class="hover:underline">Terms & Conditions</a>
        </div>
      </footer>
    </main>

    <!-- ‚úÖ Single Cart Sidebar -->
    <aside
      id="cartSidebar"
      class="fixed right-0 top-0 h-full w-[92vw] sm:w-96 transform translate-x-full transition z-50"
      aria-hidden="true"
    >
      <div class="h-full panel p-5 flex flex-col">
        <div class="flex items-center justify-between">
          <h4 class="font-semibold">Your Cart</h4>
          <button id="closeCart" class="text-gray-300">‚úï</button>
        </div>
        <div
          id="cartItems"
          class="mt-4 flex-1 overflow-auto no-scrollbar"
        ></div>
        <div class="mt-4 border-t pt-4">
          <div class="flex items-center justify-between">
            <div class="text-sm text-gray-400">Subtotal</div>
            <div id="cartSub" class="font-semibold">‚Çπ0</div>
          </div>
          <div class="mt-3 grid grid-cols-2 gap-2">
            <button id="checkoutBtn" class="gold-btn py-2 rounded-md">
              Checkout
            </button>
            <button id="clearCart" class="panel py-2 rounded-md">Clear</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- ‚úÖ Include core JS files -->
    <script src="/js/products.js"></script>
    <script src="/js/script.js"></script>

    <!-- ‚úÖ Hero Carousel Logic -->
    <script>
      const slides = document.querySelectorAll("#heroCarousel .carousel-slide");
      const dots = document.querySelectorAll("#carouselDots .dot");
      let currentSlide = 0,
        slideInterval;

      function showSlide(index) {
        slides.forEach((s, i) => s.classList.toggle("active", i === index));
        dots.forEach((d, i) => d.classList.toggle("bg-[#D4AF37]", i === index));
        currentSlide = index;
      }
      function nextSlide() {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
      }
      function startAuto() {
        slideInterval = setInterval(nextSlide, 4000);
      }
      function restartAuto() {
        clearInterval(slideInterval);
        startAuto();
      }
      dots.forEach((dot, i) =>
        dot.addEventListener("click", () => {
          showSlide(i);
          restartAuto();
        })
      );
      showSlide(currentSlide);
      startAuto();
    </script>

    <!-- ‚úÖ Render Product Grid (loads from localStorage) -->
    <!-- <script>
    const grid = document.getElementById('productsGrid');
    let PRODUCTS = JSON.parse(localStorage.getItem('vf_products')) || [];

    function renderGrid() {
      grid.innerHTML = '';
      if (!PRODUCTS || PRODUCTS.length === 0) {
        grid.innerHTML = '<p class="text-gray-400 col-span-full text-center">No products found.</p>';
        return;
      }

      PRODUCTS.forEach(p => {
        const card = document.createElement('a');
        card.href = `product.html?id=${encodeURIComponent(p.id)}`;
        card.className = 'block rounded-xl overflow-hidden shadow hover:scale-105 transition';
        card.innerHTML = `
          <img src="${p.img}" alt="${p.name}" class="w-full h-56 object-cover">
          <div class="p-4">
            <h3 class="font-semibold text-lg">${p.name}</h3>
            <p class="text-gray-400 text-sm line-clamp-2">${p.desc}</p>
            <div class="flex items-center justify-between mt-2">
              <span class="text-xl font-bold text-yellow-600">‚Çπ${p.price}</span>
            </div>
          </div>`;
        grid.appendChild(card);
      });
    }

    renderGrid();
  </script> -->

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // ===== MENU TOGGLE =====
        const menuBtn = document.getElementById("menuBtn");
        const closeMenu = document.getElementById("closeMenu");
        const mobileMenu = document.getElementById("mobileMenu");

        menuBtn?.addEventListener("click", () => {
          mobileMenu.classList.remove("translate-x-full");
        });
        closeMenu?.addEventListener("click", () => {
          mobileMenu.classList.add("translate-x-full");
        });
        document.addEventListener("click", (e) => {
          if (!mobileMenu.contains(e.target) && !menuBtn.contains(e.target)) {
            mobileMenu.classList.add("translate-x-full");
          }
        });

        // ===== CART SIDEBAR TOGGLE =====
        const cartBtn = document.getElementById("cartBtn");
        const cartSidebar = document.getElementById("cartSidebar");
        const closeCart = document.getElementById("closeCart");

        cartBtn?.addEventListener("click", () => {
          cartSidebar.classList.remove("translate-x-full");
        });
        closeCart?.addEventListener("click", () => {
          cartSidebar.classList.add("translate-x-full");
        });
        document.addEventListener("click", (e) => {
          if (!cartSidebar.contains(e.target) && !cartBtn.contains(e.target)) {
            cartSidebar.classList.add("translate-x-full");
          }
        });

        // ===== SEARCH TOGGLE (optional) =====
        const searchBtn = document.getElementById("searchBtn");
        const searchModal = document.getElementById("searchModal");
        const closeSearch = document.getElementById("closeSearch");

        searchBtn?.addEventListener("click", () => {
          searchModal?.classList.remove("hidden");
        });
        closeSearch?.addEventListener("click", () => {
          searchModal?.classList.add("hidden");
        });
      });
    </script>
    <!-- include toast script AFTER the button -->
    <script>
      // function toast(msg, opts = {}) {
      //   const { duration = 2200 } = opts;
      //   const containerId = "vf_toast_container";
      //   let container = document.getElementById(containerId);
      //   if (!container) {
      //     container = document.createElement("div");
      //     container.id = containerId;
      //     container.style.cssText =
      //       "position:fixed;z-index:99999;left:50%;bottom:28px;transform:translateX(-50%);display:flex;flex-direction:column;gap:8px;align-items:center;pointer-events:none";
      //     document.body.appendChild(container);
      //   }
      //   const t = document.createElement("div");
      //   t.textContent = msg;
      //   t.style.cssText =
      //     "background:rgba(0,0,0,0.8);color:white;padding:10px 14px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.5);pointer-events:auto;font-weight:500;";
      //   container.appendChild(t);
      //   requestAnimationFrame(() => (t.style.opacity = "1"));
      //   setTimeout(() => {
      //     t.style.transition = "opacity .25s ease, transform .25s ease";
      //     t.style.opacity = "0";
      //     t.style.transform = "translateY(8px)";
      //     setTimeout(() => t.remove(), 300);
      //   }, duration);
      // }
      function toast(msg, opts = {}) {
        const { duration = 2200, type = "info" } = opts;
        const colors = {
          success: "linear-gradient(90deg,#4CAF50,#2E7D32)",
          error: "linear-gradient(90deg,#F44336,#C62828)",
          warning: "linear-gradient(90deg,#FF9800,#E65100)",
          info: "rgba(0,0,0,0.8)",
        };
        const bg = colors[type] || colors.info;

        const containerId = "vf_toast_container";
        let container = document.getElementById(containerId);
        if (!container) {
          container = document.createElement("div");
          container.id = containerId;
          container.style.cssText =
            "position:fixed;z-index:99999;left:50%;bottom:28px;transform:translateX(-50%);display:flex;flex-direction:column;gap:8px;align-items:center;pointer-events:none";
          document.body.appendChild(container);
        }

        const t = document.createElement("div");
        t.textContent = msg;
        t.style.cssText = `background:${bg};color:white;padding:10px 14px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.5);pointer-events:auto;font-weight:500;opacity:0;transition:opacity .25s ease, transform .25s ease;`;
        container.appendChild(t);

        requestAnimationFrame(() => {
          t.style.opacity = "1";
          t.style.transform = "translateY(0)";
        });

        setTimeout(() => {
          t.style.opacity = "0";
          t.style.transform = "translateY(8px)";
          setTimeout(() => t.remove(), 300);
        }, duration);
      }
    </script>
  </body>
</html>
